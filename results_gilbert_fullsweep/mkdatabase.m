function mkdatabase()
% mkdatabase()
%   This funciton aggregates the metrics data from all idv_N directories.
%   Data is stored to a an Excel spreasheet which can be imported into the
%   Microsoft Access database, results.accdb.
%
% Rick Candell, 2014

outputxls_one = 'results_onetable.xls';

disp('Building XLS file, one page for all IDVs...')
rownum = 2;
for ii = 1:16
    disp(['IDV ' num2str(ii) '...'])
    csvpath = ['idv_' num2str(ii) '\metrics.csv'];
	sheet_name = ['IDV_all'];
    A=importdata(csvpath);
    if rownum == 2
        names = A.colheaders;
        xlswrite(outputxls_one,names,sheet_name,'A1');
    end
    values = A.data;
    Nvalues = size(A.data,1);
    xlswrite(outputxls_one,values,sheet_name, ...
        ['A' num2str(rownum)] );
    rownum = rownum+Nvalues;    
end

end

% function writeHdr(output_file)
%     domain_names = {'P','R','IDVnum'};
%     max_names = strcat({'MAX of DEVs '}, getXMeasNames(1:41));
%     var_names = strcat({'VAR of DEVs '}, getXMeasNames(1:41));
%     corr_names = getXMeasNames(1:41);
%     hdr = strjoin([domain_names max_names var_names corr_names],',');
%     fid = fopen(output_file,'w');
%     fprintf(fid,[hdr '\n']);
%     fclose(fid);
% end
% 
% function names = getXMeasNames(idx)
%     names = { ...
%         'A feed stream 1', ...
%         'D feed stream 2', ...
%         'E feed stream 3', ...
%         'A and C feed stream 4', ...
%         'Recycle flow Stream 8', ...
%         'Reactor feed rate stream 6', ...
%         'Reactor pressure', ...
%         'Reactor level', ...
%         'Reactor temperature', ...
%         'Purge rate stream 9', ...
%         'Product separator temperature ', ...
%         'Product separator level', ...
%         'Product separator pressure', ...
%         'Product separator underflow stream 10', ...
%         'stripper level', ...
%         'stripper pressure', ...
%         'Stripper underflow stream 11', ...
%         'stripper temperature', ...
%         'strippx steam dew', ...
%         'Compressor work', ...
%         'Reactor cooling water outlet temperature', ...
%         'separator cooling water outlet temperature', ...
%         'Reactor feed A', ...
%         'Reactor feed B', ...
%         'Reactor feed C', ...
%         'Reactor feed D', ...
%         'Reactor feed E', ...
%         'Reactor feed F', ...
%         'Purge gas A', ...
%         'Purge gas B', ...
%         'Purge gas C', ...
%         'Purge gas D', ...
%         'Purge gas E', ...
%         'Purge gas F', ...
%         'Purge gas G', ...
%         'Purge gas H', ...
%         'Product D', ...
%         'Product E', ...
%         'Product F', ...
%         'Product G', ...
%         'Product H' };
%     names = names(idx);
% end
